### Аутентификация через Okta

#### POST /api/session/okta_auth

Этот эндпоинт используется для аутентификации пользователей через Okta. Он принимает код авторизации, полученный от Okta после успешного входа пользователя на стороне Okta, и использует его для получения токенов доступа и информации о пользователе от Okta. Затем Metabase создает или обновляет локального пользователя на основе полученной информации и создает сессию для этого пользователя.

**Параметры тела запроса.**

- `code`: Код авторизации, полученный от Okta.
- `state`: Состояние, связанное с запросом на аутентификацию, используется для предотвращения атак CSRF.

Процесс работы этого эндпоинта включает несколько ключевых шагов:

1. **Получение настроек из конфигурации Metabase -** Metabase извлекает необходимые настройки для взаимодействия с Okta, включая домен Okta, идентификатор клиента, секрет клиента и URL для получения токена.
    
2. **Обмен кода на токен -** Metabase отправляет запрос к Okta с кодом для обмена его на токен доступа.
    
3. **Получение информации о пользователе -** Используя токен доступа, Metabase запрашивает информацию о пользователе у Okta.
    
4. **Создание или обновление пользователя -** На основе полученной информации Metabase создает нового пользователя или обновляет существующего.
    
5. **Создание сессии -** Для аутентифицированного пользователя создается новая сессия в Metabase.
    
6. **Установка кук -** Клиенту отправляются куки сессии, позволяющие ему быть аутентифицированным при последующих запросах к Metabase.
    

**Ответ.**

- `id`: Идентификатор созданной сессии.